## Amazon Aurora

이것은 AWS 고유의 기술이다. - 오픈소스X

postgres, mysql과 호환되도록 만들어졌다. - 오로라의 드라이버를 연결하면 된다.

클라우드에 최적화되어 있으며 여러 가지 똑똑한 최적화를 통해 RDS의 MySQL보다 5배 높은 성능, RDS의 Postgresql보다는 3배 높은 성능

스토리지는 자동으로 확장한다 -  10GB → 128TB : 신경쓰지 않아도 자동으로 확장되어 저장 디스크를 신경쓰지 않아도 된다.

읽기 전용 복제본의 경우, 15개의 본제본을 들 수 있다. 그리고 복제 속도도 빠르다.

장애 조치는 즉각적이다.

클라우드 네이티브로 가용성이 높다.

### Aurora High Availability and Read Scaling

1. 3 AZ에 걸쳐 무언가를 기록할 때마다 6개의 사본을 저장한다.

→ 쓰기에는 6개 중 4개만 있으면 된다.

→ 읽기에는 6개 중 3개만 있으면 된다. → 읽기 가용성이 높다.

→ 자가 복구 과정이 있다.

⇒ 문제가 있다면 백엔드에서 P2P(peer-to-peer) 복제를 통한 자가 복구가 진행된다.

→ 단일 볼륨에 의존하지 않고 수백개의 볼륨을 사용한다.

1. 쓰기를 받는 인스턴스는 하나 뿐이다. (master)
2. 마스터가 동작하지 않으면 30초 이내로 장애 조치가 시작된다.
3. 마스터 외에 읽기를 제공하는 읽기 전용 복제본을 15개까지 둘 수 있다.

→ 복제본을 많이 두고 읽기 워크로드를 스케일링할 수 있다.

1. 복제본들은 리전 간 복제를 지원한다.

---

### Aurora DB Cluster

클라이언트가 있을 때 수많은 인스턴스와 어떻게 접속할까?

마스터가 바뀌거나 장애 조치가 발생할 수 있다.

→ writer 엔드포인트를 제공한다.

- DNS 이름으로 항상 마스터를 가리킨다.
- 장애 조치 후에도 클라이언트는 엔드포인트와 상호작용하게 되며 올바른 인스턴스로 자동으로 리다이렉트된다.

읽기 전용 복제본을 15개까지 생성 가능 하며 auto scaling을 설정해서 항상 적절한 수의 읽기 전용 복제본이 존재하도록 할 수 있다.

→ reader 엔드포인트가 있다.

- 연결 로드 밸런싱에 도움을 준다.
- 모든 읽기 전용 복제본과 자동으로 연결된다.
- 클라이언트가 엔드포인트로 연결되면 읽기 전용 복제본 중 하나로 연결되며 로드 밸런싱을 도와준다.

  ⇒ 로드 밸런싱은 연결 레벨에서 일어난다!


---

### Aurora Replicas - Auto Scaling

읽기 전용 복제본들의 CPU 사용률이 오른다.

→ 복제본 auto scaling을 통해 추가로 생성된다.

→ 읽기 endpoint가 그만큼 확장된다.

→ 새 복제본들은 트래픽을 받아 읽기는 더 많이 분배된다.

→ 전체적인 CPU 사용률이 낮아진다.

### Aurora - Custom Endpoint

읽기전용 복제본들끼리 크기가 다를 수 있다.

→ aurora 인스턴스의 부분집합을 사용자 지정 엔드포인트로 정의하기 위해서

→ 특정 복제본들이 분석적 쿼리를 담당하는 게 나아 custom endpoint로 정의한다.

사용자 정의 엔드포인트를 갖게 되면 사용자 지정 엔드포인트 정의 이후에는 reader 엔드포인트 자체는 사용되지 않게 된다.

→ 각 업무마다 다양한 사용자 지정 엔드포인트를 만들어야 한다.

### Aurora Serverless

자동화된 데이터베이스 예시화와 실제 사용량에 따른 auto scaling을 제공한다.

→ 간헐적이고 예측 불가능한 업무량에 대응하는 것을 돕는다.

→ capacity planning을 할 필요가 없어진다.

**동작 방법**

1. 클라이언트는 aurora가 관리하는 프록시 플릿에 연락한다. 백엔드에는 많은 aurora 인스턴스들이 생성된다.

### Global Aurora

aurora 교차 리전 읽기 전용 복제본은 재해 복구에 도움이 되고, 실행하기 간단하다.

aurora global database가 추천된다.

→ 모든 읽기와 쓰기가 일어나는 하나의 기본 리전이 있다.

→ 최대 5개의 보조 읽기 전용 리전을 만들 수 있다. (응답 지연이 1초 이하)

→ 보조 리전 당 최대 16개 읽기 전용 복제본을 사용할 수 있다.

→ 전세계에서 오는 읽기 업무량에 따른 대기 시간을 줄이는 데 도움을 준다.

→ **평균적으로 한 리전에서 다른 리전으로 데이터를 복제하는 데에 1초 이하의 시간이 걸린다.**

### Aurora Machine Learning

aurora는 aws안에 있는 기계 학습 서비스와 통합되기도 한다.

SQL 인터페이스를 통해 애플리케이션에 기계 학습 기반의 예측을 추가할 수 있다.

aurora와 다른 aws 기계 학습 서비스 간의 간단하고 최적화된 안전한 통합이다.

- amazon sagemaker, amazon comprehend

사용 사례: 이상 행위 탐지, 광고 티켓팅, 감정 분석, 상품 추천 등